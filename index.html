<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz B√≠blico - Multiplayer</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* ... (todo o CSS permanece igual) ... */
    </style>
</head>
<body>
    <div class="container">
        <!-- ... (todo o HTML permanece igual) ... -->
    </div>

    <script>
        // Dados do jogo (permanecem iguais)
        const perguntas = {
            "facil": [
                {
                    "pergunta": "Quem construiu a arca?",
                    "opcoes": ["Mois√©s", "No√©", "Abra√£o", "Josu√©"],
                    "resposta": "No√©"
                },
                {
                    "pergunta": "Quantos disc√≠pulos Jesus escolheu?",
                    "opcoes": ["7", "12", "10", "15"],
                    "resposta": "12"
                },
                {
                    "pergunta": "Qual foi o primeiro milagre de Jesus?",
                    "opcoes": ["Cura do cego", "Ressurrei√ß√£o de L√°zaro", "Transforma√ß√£o de √°gua em vinho", "Caminhar sobre as √°guas"],
                    "resposta": "Transforma√ß√£o de √°gua em vinho"
                },
                {
                    "pergunta": "Quem foi jogado na cova dos le√µes?",
                    "opcoes": ["Jos√©", "Davi", "Daniel", "Jonas"],
                    "resposta": "Daniel"
                },
                {
                    "pergunta": "Qual √© o primeiro livro da B√≠blia?",
                    "opcoes": ["√äxodo", "G√™nesis", "Mateus", "Salmos"],
                    "resposta": "G√™nesis"
                }
            ],
            "medio": [
                {
                    "pergunta": "Qual ap√≥stolo era coletor de impostos antes de seguir Jesus?",
                    "opcoes": ["Pedro", "Jo√£o", "Mateus", "Andr√©"],
                    "resposta": "Mateus"
                },
                {
                    "pergunta": "Quem foi o primeiro m√°rtir da igreja crist√£?",
                    "opcoes": ["Pedro", "Paulo", "Est√™v√£o", "Tiago"],
                    "resposta": "Est√™v√£o"
                },
                {
                    "pergunta": "Qual profeta foi engolido por um grande peixe?",
                    "opcoes": ["Jeremias", "Isa√≠as", "Jonas", "Ezequiel"],
                    "resposta": "Jonas"
                },
                {
                    "pergunta": "Quem interpretou o sonho de Fara√≥ sobre as vacas magras e gordas?",
                    "opcoes": ["Mois√©s", "Jos√©", "Daniel", "Salom√£o"],
                    "resposta": "Jos√©"
                }
            ],
            "dificil": [
                {
                    "pergunta": "Quantos anos tinha No√© quando come√ßou a chover para o dil√∫vio?",
                    "opcoes": ["500 anos", "600 anos", "700 anos", "800 anos"],
                    "resposta": "600 anos"
                },
                {
                    "pergunta": "Qual ap√≥stolo era conhecido como 'Zelote'?",
                    "opcoes": ["Sim√£o", "Judas Iscariotes", "Judas Tadeu", "Tiago"],
                    "resposta": "Sim√£o"
                },
                {
                    "pergunta": "Em qual livro da B√≠blia encontramos a hist√≥ria de Ester?",
                    "opcoes": ["Rute", "Ester", "Esdras", "Neemias"],
                    "resposta": "Ester"
                },
                {
                    "pergunta": "Quem foi o pai de Isaque?",
                    "opcoes": ["Abra√£o", "Jac√≥", "Ismael", "Esa√∫"],
                    "resposta": "Abra√£o"
                }
            ]
        };

        const figurinhas = [
            { nome: "Pomba Branca", categoria: "comum", icon: "üïäÔ∏è" },
            { nome: "Arca de No√©", categoria: "comum", icon: "üö¢" },
            { nome: "T√°buas da Lei", categoria: "comum", icon: "üìú" },
            { nome: "Cruz", categoria: "comum", icon: "‚úùÔ∏è" },
            { nome: "Peixe Crist√£o", categoria: "comum", icon: "üêü" },
            { nome: "David com Harpa", categoria: "rara", icon: "üéµ" },
            { nome: "Sans√£o", categoria: "rara", icon: "üí™" },
            { nome: "Muro de Jeric√≥", categoria: "rara", icon: "üß±" },
            { nome: "Man√° do C√©u", categoria: "rara", icon: "üçû" },
            { nome: "Arca da Alian√ßa", categoria: "lendaria", icon: "üì¶" },
            { nome: "Ressurrei√ß√£o", categoria: "lendaria", icon: "‚ú®" },
            { nome: "Transfigura√ß√£o", categoria: "lendaria", icon: "üåü" }
        ];

        // Simula√ß√£o do Backend com Socket.IO (permanece igual)
        class SocketIOSimulado {
            // ... (todo o c√≥digo da classe SocketIOSimulado permanece igual) ...
        }

        // Estado do jogo
        let estadoJogo = {
            jogador: {
                id: null,
                nome: "Jogador",
                pontuacao: 0,
                figurinhas: []
            },
            modo: null,
            dificuldade: null,
            perguntaAtual: null,
            perguntasRespondidas: [],
            tempoRestante: 30,
            intervalo: null,
            opcaoSelecionada: null,
            sala: null,
            socket: null
        };

        // Inicializar socket simulado
        estadoJogo.socket = new SocketIOSimulado();

        // Elementos da interface (permanecem iguais)
        const telas = document.querySelectorAll('.tela');
        const telaInicial = document.getElementById('tela-inicial');
        const telaDificuldade = document.getElementById('tela-dificuldade');
        const telaPergunta = document.getElementById('tela-pergunta');
        const telaResultado = document.getElementById('tela-resultado');
        const telaMultiplayer = document.getElementById('tela-multiplayer');
        const telaEntrarSala = document.getElementById('tela-entrar-sala');
        const telaSala = document.getElementById('tela-sala');
        const telaPerguntaMultiplayer = document.getElementById('tela-pergunta-multiplayer');
        const telaResultadoMultiplayer = document.getElementById('tela-resultado-multiplayer');
        const telaRanking = document.getElementById('tela-ranking');
        const telaAlbum = document.getElementById('tela-album');

        // Configurar listeners do socket (permanecem iguais)
        estadoJogo.socket.on('salaCriada', (dados) => {
            estadoJogo.sala = dados.sala;
            atualizarTelaSala();
            mostrarTela(telaSala);
        });

        estadoJogo.socket.on('entradaConfirmada', (dados) => {
            estadoJogo.sala = dados.sala;
            atualizarTelaSala();
            mostrarTela(telaSala);
        });

        estadoJogo.socket.on('erroEntrada', (dados) => {
            alert(dados.mensagem);
        });

        estadoJogo.socket.on('jogadoresAtualizados', (dados) => {
            if (estadoJogo.sala && estadoJogo.sala.id === dados.salaId) {
                estadoJogo.sala.jogadores = dados.jogadores;
                estadoJogo.sala.dono = dados.dono;
                atualizarTelaSala();
            }
        });

        estadoJogo.socket.on('novoJogador', (dados) => {
            if (estadoJogo.sala && estadoJogo.sala.id === dados.salaId) {
                adicionarMensagemSistema(`${dados.jogador.nome} entrou na sala`);
            }
        });

        estadoJogo.socket.on('jogadorSaiu', (dados) => {
            if (estadoJogo.sala && estadoJogo.sala.id === dados.salaId) {
                adicionarMensagemSistema('Um jogador saiu da sala');
            }
        });

        estadoJogo.socket.on('jogoIniciado', (dados) => {
            if (estadoJogo.sala && estadoJogo.sala.id === dados.salaId) {
                document.getElementById('aguardando-inicio').style.display = 'none';
                adicionarMensagemSistema('Jogo iniciando...');
            }
        });

        estadoJogo.socket.on('novaPergunta', (dados) => {
            if (estadoJogo.sala && estadoJogo.sala.id === dados.salaId) {
                estadoJogo.sala.perguntaAtual = dados.pergunta;
                estadoJogo.sala.rodadaAtual = dados.rodada;
                estadoJogo.sala.tempoRestante = 15;
                carregarPerguntaMultiplayer(dados.pergunta, dados.rodada, dados.totalRodadas);
                mostrarTela(telaPerguntaMultiplayer);
            }
        });

        estadoJogo.socket.on('tempoAtualizado', (dados) => {
            if (estadoJogo.sala && estadoJogo.sala.id === dados.salaId) {
                document.getElementById('tempo-restante-multi').textContent = dados.tempoRestante;
                const progresso = (dados.tempoRestante / 15) * 100;
                document.getElementById('barra-progresso-multi').style.width = `${progresso}%`;
            }
        });

        estadoJogo.socket.on('respostaRegistrada', (dados) => {
            if (estadoJogo.sala && estadoJogo.sala.id === dados.salaId) {
                atualizarRankingSala();
            }
        });

        estadoJogo.socket.on('rodadaFinalizada', (dados) => {
            if (estadoJogo.sala && estadoJogo.sala.id === dados.salaId) {
                mostrarResultadoMultiplayer(dados);
            }
        });

        // Fun√ß√µes de navega√ß√£o (permanecem iguais)
        function mostrarTela(tela) {
            telas.forEach(t => t.classList.remove('ativa'));
            tela.classList.add('ativa');
        }

        // Event listeners para navega√ß√£o (permanecem iguais)
        document.getElementById('btn-solo').addEventListener('click', () => {
            estadoJogo.modo = 'solo';
            mostrarTela(telaDificuldade);
        });

        document.getElementById('btn-multiplayer').addEventListener('click', () => {
            estadoJogo.modo = 'multiplayer';
            mostrarTela(telaMultiplayer);
        });

        document.getElementById('btn-ranking').addEventListener('click', () => {
            carregarRanking();
            mostrarTela(telaRanking);
        });

        document.getElementById('btn-album').addEventListener('click', () => {
            carregarAlbum();
            mostrarTela(telaAlbum);
        });

        document.querySelectorAll('.voltar-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                if (estadoJogo.sala) {
                    estadoJogo.socket.emit('sairSala', {
                        jogadorId: estadoJogo.jogador.id
                    });
                    estadoJogo.sala = null;
                }
                mostrarTela(telaInicial);
                resetarJogo();
            });
        });

        // Modo Solo - Sele√ß√£o de dificuldade (permanece igual)
        document.querySelectorAll('.dificuldade-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                estadoJogo.dificuldade = e.target.dataset.dificuldade;
                iniciarJogoSolo();
            });
        });

        // Modo Solo - Iniciar jogo (permanece igual)
        function iniciarJogoSolo() {
            estadoJogo.perguntasRespondidas = [];
            estadoJogo.jogador.pontuacao = 0;
            carregarPergunta();
            mostrarTela(telaPergunta);
        }

        // Carregar pergunta aleat√≥ria (Solo) - permanece igual
        function carregarPergunta() {
            const perguntasDisponiveis = perguntas[estadoJogo.dificuldade].filter(
                p => !estadoJogo.perguntasRespondidas.includes(p.pergunta)
            );
            
            if (perguntasDisponiveis.length === 0) {
                alert('Parab√©ns! Voc√™ completou todas as perguntas deste n√≠vel!');
                mostrarTela(telaInicial);
                return;
            }
            
            const indiceAleatorio = Math.floor(Math.random() * perguntasDisponiveis.length);
            estadoJogo.perguntaAtual = perguntasDisponiveis[indiceAleatorio];
            
            document.getElementById('texto-pergunta').textContent = estadoJogo.perguntaAtual.pergunta;
            
            const opcoesContainer = document.getElementById('opcoes-container');
            opcoesContainer.innerHTML = '';
            
            estadoJogo.perguntaAtual.opcoes.forEach(opcao => {
                const divOpcao = document.createElement('div');
                divOpcao.className = 'opcao';
                divOpcao.textContent = opcao;
                divOpcao.addEventListener('click', () => selecionarOpcao(divOpcao, opcao));
                opcoesContainer.appendChild(divOpcao);
            });
            
            estadoJogo.opcaoSelecionada = null;
            document.getElementById('btn-confirmar').disabled = true;
            estadoJogo.tempoRestante = 30;
            document.getElementById('tempo-restante').textContent = estadoJogo.tempoRestante;
            
            const progresso = (estadoJogo.perguntasRespondidas.length / perguntas[estadoJogo.dificuldade].length) * 100;
            document.getElementById('barra-progresso').style.width = `${progresso}%`;
            
            clearInterval(estadoJogo.intervalo);
            estadoJogo.intervalo = setInterval(atualizarTempo, 1000);
        }

        function selecionarOpcao(elemento, opcao) {
            document.querySelectorAll('.opcao').forEach(op => {
                op.classList.remove('selecionada');
            });
            
            elemento.classList.add('selecionada');
            estadoJogo.opcaoSelecionada = opcao;
            document.getElementById('btn-confirmar').disabled = false;
        }

        document.getElementById('btn-confirmar').addEventListener('click', verificarResposta);

        function verificarResposta() {
            clearInterval(estadoJogo.intervalo);
            
            estadoJogo.perguntasRespondidas.push(estadoJogo.perguntaAtual.pergunta);
            
            const correta = estadoJogo.opcaoSelecionada === estadoJogo.perguntaAtual.resposta;
            
            let pontos = 0;
            if (correta) {
                switch(estadoJogo.dificuldade) {
                    case 'facil': pontos = 10; break;
                    case 'medio': pontos = 20; break;
                    case 'dificil': pontos = 30; break;
                }
                estadoJogo.jogador.pontuacao += pontos;
            }
            
            mostrarResultado(correta, pontos);
        }

        function atualizarTempo() {
            estadoJogo.tempoRestante--;
            document.getElementById('tempo-restante').textContent = estadoJogo.tempoRestante;
            
            if (estadoJogo.tempoRestante <= 0) {
                clearInterval(estadoJogo.intervalo);
                estadoJogo.perguntasRespondidas.push(estadoJogo.perguntaAtual.pergunta);
                mostrarResultado(false, 0);
            }
        }

        function mostrarResultado(correta, pontos) {
            const resultadoTexto = document.getElementById('resultado-texto');
            const figurinhaContainer = document.getElementById('figurinha-ganha-container');
            
            if (correta) {
                resultadoTexto.textContent = "Resposta Correta!";
                resultadoTexto.className = "resultado-acerto";
                
                if (Math.random() < 0.5) {
                    const figurinha = ganharFigurinha();
                    if (figurinha) {
                        figurinhaContainer.style.display = 'block';
                        document.getElementById('figurinha-ganha-info').innerHTML = `
                            <div class="figurinha-icon">${figurinha.icon}</div>
                            <div class="figurinha-nome">${figurinha.nome}</div>
                            <div class="figurinha-categoria">${figurinha.categoria}</div>
                        `;
                    } else {
                        figurinhaContainer.style.display = 'none';
                    }
                } else {
                    figurinhaContainer.style.display = 'none';
                }
            } else {
                resultadoTexto.textContent = "Resposta Incorreta!";
                resultadoTexto.className = "resultado-erro";
                figurinhaContainer.style.display = 'none';
            }
            
            document.getElementById('pontuacao-atual').textContent = estadoJogo.jogador.pontuacao;
            mostrarTela(telaResultado);
        }

        // FUN√á√ÉO COMPLETADA: Ganhar figurinha
        function ganharFigurinha() {
            let probComum = 0.7;
            let probRara = 0.25;
            let probLendaria = 0.05;
            
            if (estadoJogo.dificuldade === 'medio') {
                probComum = 0.6;
                probRara = 0.3;
                probLendaria = 0.1;
            } else if (estadoJogo.dificuldade === 'dificil') {
                probComum = 0.5;
                probRara = 0.35;
                probLendaria = 0.15;
            }
            
            const rand = Math.random();
            let categoria;
            
            if (rand < probComum) {
                categoria = 'comum';
            } else if (rand < probComum + probRara) {
                categoria = 'rara';
            } else {
                categoria = 'lendaria';
            }
            
            const figurinhasDisponiveis = figurinhas.filter(f => 
                f.categoria === categoria && 
                !estadoJogo.jogador.figurinhas.some(jf => jf.nome === f.nome)
            );
            
            if (figurinhasDisponiveis.length === 0) {
                return null;
            }
            
            const indiceAleatorio = Math.floor(Math.random() * figurinhasDisponiveis.length);
            const figurinha = figurinhasDisponiveis[indiceAleatorio];
            
            estadoJogo.jogador.figurinhas.push(figurinha);
            
            return figurinha;
        }

        // Modo Multiplayer (permanece igual)
        document.getElementById('btn-criar-sala').addEventListener('click', criarSala);
        document.getElementById('btn-entrar-sala').addEventListener('click', () => {
            mostrarTela(telaEntrarSala);
        });

        document.getElementById('btn-confirmar-entrada').addEventListener('click', entrarSala);

        function criarSala() {
            if (!estadoJogo.jogador.id) {
                estadoJogo.jogador.id = 'jogador_' + Date.now();
            }
            
            estadoJogo.socket.emit('criarSala', {
                jogador: estadoJogo.jogador
            });
        }

        function entrarSala() {
            const salaId = document.getElementById('input-id-sala').value.toUpperCase();
            if (!salaId || salaId.length !== 6) {
                alert('Digite um ID de sala v√°lido (6 caracteres)');
                return;
            }

            if (!estadoJogo.jogador.id) {
                estadoJogo.jogador.id = 'jogador_' + Date.now();
            }
            
            estadoJogo.socket.emit('entrarSala', {
                salaId: salaId,
                jogador: estadoJogo.jogador
            });
        }

        function atualizarTelaSala() {
            if (!estadoJogo.sala) return;

            document.getElementById('sala-id').textContent = estadoJogo.sala.id;
            document.getElementById('contador-jogadores').textContent = estadoJogo.sala.jogadores.length;
            document.getElementById('status-sala').textContent = 
                estadoJogo.sala.estado === 'aguardando' ? 'Aguardando jogadores...' : 'Jogo em andamento';
            
            const jogadoresContainer = document.getElementById('jogadores-sala');
            jogadoresContainer.innerHTML = '';
            
            estadoJogo.sala.jogadores.forEach(jogador => {
                const divJogador = document.createElement('div');
                divJogador.className = 'jogador-item';
                
                if (jogador.id === estadoJogo.sala.dono) {
                    divJogador.classList.add('dono');
                    divJogador.innerHTML = `üëë ${jogador.nome} (Dono)`;
                } else if (jogador.id === estadoJogo.jogador.id) {
                    divJogador.classList.add('eu');
                    divJogador.innerHTML = `‚≠ê ${jogador.nome} (Voc√™)`;
                } else {
                    divJogador.textContent = jogador.nome;
                }
                
                jogadoresContainer.appendChild(divJogador);
            });
            
            const btnIniciar = document.getElementById('btn-iniciar-jogo');
            if (estadoJogo.sala.dono === estadoJogo.jogador.id) {
                btnIniciar.style.display = 'block';
                btnIniciar.disabled = estadoJogo.sala.jogadores.length < 2;
            } else {
                btnIniciar.style.display = 'none';
            }

            document.getElementById('aguardando-inicio').style.display = 
                estadoJogo.sala.estado === 'aguardando' ? 'block' : 'none';
        }

        document.getElementById('btn-iniciar-jogo').addEventListener('click', () => {
            estadoJogo.socket.emit('iniciarJogo', {
                salaId: estadoJogo.sala.id,
                jogadorId: estadoJogo.jogador.id
            });
        });

        function adicionarMensagemSistema(mensagem) {
            const mensagemElemento = document.createElement('div');
            mensagemElemento.className = 'mensagem-sistema';
            mensagemElemento.textContent = mensagem;
            
            const salaContainer = document.querySelector('#tela-sala .sala-container');
            salaContainer.appendChild(mensagemElemento);
            
            mensagemElemento.scrollIntoView({ behavior: 'smooth' });
            
            setTimeout(() => {
                if (mensagemElemento.parentNode) {
                    mensagemElemento.parentNode.removeChild(mensagemElemento);
                }
            }, 5000);
        }

        // Perguntas Multiplayer (permanecem iguais)
        function carregarPerguntaMultiplayer(pergunta, rodada, totalRodadas) {
            document.getElementById('texto-pergunta-multi').textContent = `Rodada ${rodada}/${totalRodadas}: ${pergunta.pergunta}`;
            
            const opcoesContainer = document.getElementById('opcoes-container-multi');
            opcoesContainer.innerHTML = '';
            
            pergunta.opcoes.forEach(opcao => {
                const divOpcao = document.createElement('div');
                divOpcao.className = 'opcao';
                divOpcao.textContent = opcao;
                divOpcao.addEventListener('click', () => responderPerguntaMultiplayer(opcao, divOpcao));
                opcoesContainer.appendChild(divOpcao);
            });
            
            document.getElementById('tempo-restante-multi').textContent = '15';
            document.getElementById('barra-progresso-multi').style.width = '100%';
            
            atualizarRankingSala();
        }

        function responderPerguntaMultiplayer(resposta, elemento) {
            document.querySelectorAll('#opcoes-container-multi .opcao').forEach(opcao => {
                opcao.style.pointerEvents = 'none';
            });
            
            elemento.classList.add('selecionada');
            
            estadoJogo.socket.emit('responderPergunta', {
                salaId: estadoJogo.sala.id,
                jogadorId: estadoJogo.jogador.id,
                resposta: resposta
            });
        }

        function atualizarRankingSala() {
            if (!estadoJogo.sala) return;

            const rankingContainer = document.getElementById('ranking-sala');
            rankingContainer.innerHTML = '<h3>Ranking da Sala</h3>';
            
            const jogadoresOrdenados = [...estadoJogo.sala.jogadores].sort((a, b) => 
                (b.pontuacao || 0) - (a.pontuacao || 0)
            );
            
            jogadoresOrdenados.forEach((jogador, index) => {
                const divRanking = document.createElement('div');
                divRanking.className = 'ranking-sala-item';
                
                if (jogador.id === estadoJogo.jogador.id) {
                    divRanking.classList.add('destaque');
                }
                
                const respondeu = estadoJogo.sala.respostas && 
                                 estadoJogo.sala.respostas.has(jogador.id);
                
                divRanking.innerHTML = `
                    <div>
                        <strong>${index + 1}¬∫ ${jogador.nome}</strong>
                        ${jogador.id === estadoJogo.jogador.id ? '(Voc√™)' : ''}
                        ${respondeu ? '‚úÖ' : '‚è≥'}
                    </div>
                    <div>${jogador.pontuacao || 0} pontos</div>
                `;
                
                rankingContainer.appendChild(divRanking);
            });
        }

        function mostrarResultadoMultiplayer(dados) {
            const meuResultado = dados.resultados.find(r => 
                r.jogador.id === estadoJogo.jogador.id
            );
            
            document.getElementById('resultado-texto-multi').textContent = 
                meuResultado.acertou ? 'Resposta Correta!' : 'Resposta Incorreta!';
            document.getElementById('resultado-texto-multi').className = 
                meuResultado.acertou ? 'resultado-acerto' : 'resultado-erro';
            document.getElementById('pontuacao-rodada').textContent = meuResultado.pontos;
            
            const rankingContainer = document.getElementById('ranking-rodada');
            rankingContainer.innerHTML = '';
            
            dados.resultados.forEach((resultado, index) => {
                const divRanking = document.createElement('div');
                divRanking.className = 'ranking-sala-item';
                
                if (resultado.jogador.id === estadoJogo.jogador.id) {
                    divRanking.classList.add('destaque');
                }
                
                divRanking.innerHTML = `
                    <div>
                        <strong>${index + 1}¬∫ ${resultado.jogador.nome}</strong>
                        ${resultado.jogador.id === estadoJogo.jogador.id ? '(Voc√™)' : ''}
                    </div>
                    <div>
                        <div>+${resultado.pontos} pts (Total: ${resultado.pontosTotais})</div>
                        <div class="progresso-jogador" style="width: ${(resultado.pontosTotais / (dados.rodada * 15)) * 100}%"></div>
                    </div>
                `;
                
                rankingContainer.appendChild(divRanking);
            });
            
            mostrarTela(telaResultadoMultiplayer);
            
            if (dados.rodada === dados.totalRodadas) {
                setTimeout(() => {
                    mostrarTela(telaSala);
                }, 5000);
            }
        }

        // FUN√á√ÉO COMPLETADA: Carregar ranking
        function carregarRanking() {
            const ranking = [
                { nome: "Maria", pontuacao: 150 },
                { nome: "Jo√£o", pontuacao: 120 },
                { nome: "Pedro", pontuacao: 100 },
                { nome: "Ana", pontuacao: 90 },
                { nome: "Jos√©", pontuacao: 80 },
                { nome: estadoJogo.jogador.nome, pontuacao: estadoJogo.jogador.pontuacao }
            ].sort((a, b) => b.pontuacao - a.pontuacao);
            
            const rankingContainer = document.getElementById('ranking-container');
            rankingContainer.innerHTML = '';
            
            ranking.forEach((jogador, index) => {
                const divRanking = document.createElement('div');
                divRanking.className = 'ranking-item';
                divRanking.innerHTML = `
                    <div>
                        <span class="ranking-posicao">${index + 1}¬∫</span> 
                        ${jogador.nome}
                    </div>
                    <div>${jogador.pontuacao} pontos</div>
                `;
                
                if (jogador.nome === estadoJogo.jogador.nome) {
                    divRanking.style.backgroundColor = 'rgba(74, 144, 226, 0.3)';
                }
                
                rankingContainer.appendChild(divRanking);
            });
        }

        // FUN√á√ÉO COMPLETADA: Carregar √°lbum
        function carregarAlbum() {
            const albumContainer = document.getElementById('album-container');
            albumContainer.innerHTML = '';
            
            if (estadoJogo.jogador.figurinhas.length === 0) {
                albumContainer.innerHTML = '<div class="vazia">Voc√™ ainda n√£o possui figurinhas. Jogue no modo Solo para coletar!</div>';
                return;
            }
            
            estadoJogo.jogador.figurinhas.forEach(figurinha => {
                const card = document.createElement('div');
                card.className = `figurinha-card ${figurinha.categoria}`;
                card.innerHTML = `
                    <div class="figurinha-icon">${figurinha.icon}</div>
                    <div class="figurinha-nome">${figurinha.nome}</div>
                    <div class="figurinha-categoria">${figurinha.categoria}</div>
                `;
                albumContainer.appendChild(card);
            });
        }

        // FUN√á√ÉO COMPLETADA: Resetar jogo
        function resetarJogo() {
            clearInterval(estadoJogo.intervalo);
            estadoJogo.modo = null;
            estadoJogo.dificuldade = null;
            estadoJogo.perguntaAtual = null;
            estadoJogo.perguntasRespondidas = [];
            estadoJogo.tempoRestante = 30;
            estadoJogo.opcaoSelecionada = null;
            estadoJogo.sala = null;
        }

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', () => {
            const dadosSalvos = localStorage.getItem('quizBiblicoJogador');
            if (dadosSalvos) {
                const dados = JSON.parse(dadosSalvos);
                estadoJogo.jogador = { ...estadoJogo.jogador, ...dados };
            }
            
            if (!estadoJogo.jogador.id) {
                estadoJogo.jogador.id = 'jogador_' + Date.now();
            }
            
            setInterval(() => {
                localStorage.setItem('quizBiblicoJogador', JSON.stringify(estadoJogo.jogador));
            }, 5000);
        });

        // Filtro de categorias no √°lbum
        document.querySelectorAll('.filtro-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                document.querySelectorAll('.filtro-btn').forEach(b => b.classList.remove('ativo'));
                e.target.classList.add('ativo');
                filtrarAlbum(e.target.dataset.categoria);
            });
        });

        function filtrarAlbum(categoria) {
            const cards = document.querySelectorAll('.figurinha-card');
            cards.forEach(card => {
                if (categoria === 'todas' || card.classList.contains(categoria)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Adicionar listener para pr√≥xima pergunta (que estava faltando)
        document.getElementById('btn-proxima-pergunta').addEventListener('click', () => {
            carregarPergunta();
            mostrarTela(telaPergunta);
        });
    </script>
</body>
</html>