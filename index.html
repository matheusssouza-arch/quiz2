<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz B√≠blico - Multiplayer</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --azul-vibrante: #4A90E2;
            --roxo: #8E44AD;
            --dourado: #F1C40F;
            --branco: #FFFFFF;
            --cinza-claro: #F5F5F5;
            --cinza-escuro: #333333;
            --verde: #2ECC71;
            --vermelho: #E74C3C;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--roxo);
            color: var(--branco);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        h1, h2, h3 {
            font-family: 'Montserrat', sans-serif;
            text-align: center;
            margin-bottom: 20px;
        }
        
        h1 {
            font-size: 2.5rem;
            color: var(--dourado);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        button {
            background-color: var(--azul-vibrante);
            color: var(--branco);
            border: none;
            border-radius: 8px;
            padding: 12px 24px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Roboto', sans-serif;
            margin: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            background-color: #3a7bc8;
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button:disabled {
            background-color: #7a7a7a;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .tela {
            display: none;
            width: 100%;
            flex-direction: column;
            align-items: center;
            animation: fadeIn 0.5s ease;
        }
        
        .tela.ativa {
            display: flex;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .menu-opcoes {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 30px;
        }
        
        .menu-opcoes button {
            min-width: 200px;
            height: 80px;
            font-size: 1.3rem;
        }
        
        .pergunta-container {
            background-color: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            width: 100%;
            max-width: 800px;
        }
        
        .pergunta-texto {
            font-size: 1.4rem;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .opcoes-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }
        
        @media (min-width: 768px) {
            .opcoes-container {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .opcao {
            background-color: rgba(255, 255, 255, 0.2);
            border: 2px solid transparent;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }
        
        .opcao:hover {
            background-color: rgba(255, 255, 255, 0.3);
            border-color: var(--azul-vibrante);
        }
        
        .opcao.selecionada {
            background-color: var(--azul-vibrante);
            border-color: var(--dourado);
        }
        
        .opcao.correta {
            background-color: var(--verde);
            border-color: var(--dourado);
        }
        
        .opcao.incorreta {
            background-color: var(--vermelho);
        }
        
        .barra-progresso {
            width: 100%;
            height: 10px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progresso {
            height: 100%;
            background-color: var(--dourado);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .contador-tempo {
            font-size: 1.2rem;
            margin: 10px 0;
            text-align: center;
        }
        
        .resultado-container {
            text-align: center;
            margin: 20px 0;
        }
        
        .resultado-acerto {
            color: var(--verde);
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        
        .resultado-erro {
            color: var(--vermelho);
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        
        .figurinha-ganha {
            background-color: var(--dourado);
            color: var(--cinza-escuro);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .ranking-container {
            width: 100%;
            max-width: 600px;
            margin: 20px 0;
        }
        
        .ranking-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 15px;
            background-color: rgba(255, 255, 255, 0.1);
            margin: 5px 0;
            border-radius: 5px;
            transition: transform 0.3s ease;
        }
        
        .ranking-item:hover {
            transform: translateX(5px);
        }
        
        .ranking-posicao {
            font-weight: bold;
            color: var(--dourado);
        }
        
        .album-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            width: 100%;
            margin: 20px 0;
        }
        
        .figurinha-card {
            background-color: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .figurinha-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .figurinha-card.comum {
            border: 2px solid var(--azul-vibrante);
        }
        
        .figurinha-card.rara {
            border: 2px solid var(--dourado);
            animation: brilho 2s infinite;
        }
        
        .figurinha-card.lendaria {
            border: 2px solid var(--roxo);
            animation: brilhoIntenso 1.5s infinite;
        }
        
        @keyframes brilho {
            0% { box-shadow: 0 0 5px var(--dourado); }
            50% { box-shadow: 0 0 20px var(--dourado); }
            100% { box-shadow: 0 0 5px var(--dourado); }
        }
        
        @keyframes brilhoIntenso {
            0% { box-shadow: 0 0 10px var(--roxo); }
            50% { box-shadow: 0 0 30px var(--roxo); }
            100% { box-shadow: 0 0 10px var(--roxo); }
        }
        
        .figurinha-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }
        
        .figurinha-nome {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .figurinha-categoria {
            font-size: 0.8rem;
            opacity: 0.8;
        }
        
        .sala-container {
            width: 100%;
            max-width: 600px;
            margin: 20px 0;
        }
        
        .sala-info {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .jogadores-sala {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .jogador-item {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .jogador-item.dono {
            border: 2px solid var(--dourado);
        }
        
        .jogador-item.eu {
            background-color: rgba(74, 144, 226, 0.3);
        }
        
        .sala-aguardando {
            text-align: center;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .input-sala {
            background-color: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 8px;
            padding: 12px;
            color: var(--branco);
            font-size: 1.1rem;
            margin: 10px;
            width: 200px;
            text-align: center;
        }
        
        .input-sala::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        
        .ranking-sala {
            width: 100%;
            margin: 20px 0;
        }
        
        .ranking-sala-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background-color: rgba(255, 255, 255, 0.1);
            margin: 5px 0;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        
        .ranking-sala-item.destaque {
            background-color: rgba(241, 196, 15, 0.2);
            border-left: 4px solid var(--dourado);
        }
        
        .progresso-jogador {
            height: 5px;
            background-color: var(--azul-vibrante);
            margin-top: 5px;
            border-radius: 3px;
            transition: width 0.5s ease;
        }
        
        .mensagem-sistema {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
            font-style: italic;
        }
        
        .filtro-categorias {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .filtro-btn {
            background-color: rgba(255, 255, 255, 0.1);
            margin: 5px;
        }
        
        .filtro-btn.ativo {
            background-color: var(--azul-vibrante);
        }
        
        .vazia {
            text-align: center;
            padding: 30px;
            opacity: 0.7;
        }
        
        .voltar-btn {
            background-color: rgba(255, 255, 255, 0.2);
            margin-top: 20px;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            button {
                padding: 10px 20px;
                font-size: 1rem;
            }
            
            .menu-opcoes button {
                min-width: 150px;
                height: 70px;
                font-size: 1.1rem;
            }
            
            .pergunta-texto {
                font-size: 1.2rem;
            }
            
            .album-container {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
            
            .jogadores-sala {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Tela Inicial -->
        <div id="tela-inicial" class="tela ativa">
            <h1>Quiz B√≠blico</h1>
            <p>Teste seu conhecimento b√≠blico, coleciona figurinhas e divirta-se!</p>
            
            <div class="menu-opcoes">
                <button id="btn-solo">Modo Solo</button>
                <button id="btn-multiplayer">Modo Multiplayer</button>
                <button id="btn-ranking">Ranking Global</button>
                <button id="btn-album">√Ålbum de Figurinhas</button>
            </div>
        </div>
        
        <!-- Tela de Sele√ß√£o de Dificuldade (Solo) -->
        <div id="tela-dificuldade" class="tela">
            <h2>Escolha a Dificuldade</h2>
            <div class="menu-opcoes">
                <button class="dificuldade-btn" data-dificuldade="facil">F√°cil</button>
                <button class="dificuldade-btn" data-dificuldade="medio">M√©dio</button>
                <button class="dificuldade-btn" data-dificuldade="dificil">Dif√≠cil</button>
            </div>
            <button class="voltar-btn">Voltar</button>
        </div>
        
        <!-- Tela de Pergunta (Solo) -->
        <div id="tela-pergunta" class="tela">
            <h2>Modo Solo</h2>
            <div class="contador-tempo">Tempo: <span id="tempo-restante">30</span>s</div>
            <div class="barra-progresso">
                <div class="progresso" id="barra-progresso"></div>
            </div>
            
            <div class="pergunta-container">
                <div class="pergunta-texto" id="texto-pergunta">Carregando pergunta...</div>
                <div class="opcoes-container" id="opcoes-container">
                    <!-- Op√ß√µes ser√£o inseridas dinamicamente -->
                </div>
            </div>
            
            <button id="btn-confirmar" disabled>Confirmar Resposta</button>
        </div>
        
        <!-- Tela de Resultado (Solo) -->
        <div id="tela-resultado" class="tela">
            <h2>Resultado</h2>
            <div class="resultado-container">
                <div id="resultado-texto" class="resultado-acerto">Resposta Correta!</div>
                <div id="figurinha-ganha-container" class="figurinha-ganha" style="display: none;">
                    <h3>Nova Figurinha!</h3>
                    <div id="figurinha-ganha-info"></div>
                </div>
                <p>Sua pontua√ß√£o: <span id="pontuacao-atual">0</span> pontos</p>
            </div>
            <button id="btn-proxima-pergunta">Pr√≥xima Pergunta</button>
            <button class="voltar-btn">Voltar ao In√≠cio</button>
        </div>
        
        <!-- Tela de Multiplayer -->
        <div id="tela-multiplayer" class="tela">
            <h2>Modo Multiplayer</h2>
            <div class="menu-opcoes">
                <button id="btn-criar-sala">Criar Sala</button>
                <button id="btn-entrar-sala">Entrar em Sala</button>
            </div>
            <button class="voltar-btn">Voltar</button>
        </div>
        
        <!-- Tela de Entrada na Sala -->
        <div id="tela-entrar-sala" class="tela">
            <h2>Entrar em Sala</h2>
            <div class="sala-aguardando">
                <p>Digite o ID da sala:</p>
                <input type="text" class="input-sala" id="input-id-sala" placeholder="Ex: ABC123" maxlength="6">
                <br>
                <button id="btn-confirmar-entrada">Entrar na Sala</button>
            </div>
            <button class="voltar-btn">Voltar</button>
        </div>
        
        <!-- Tela de Sala (Multiplayer) -->
        <div id="tela-sala" class="tela">
            <h2>Sala Multiplayer</h2>
            <div class="sala-info">
                <p>ID da Sala: <span id="sala-id">ABC123</span></p>
                <p>Jogadores: <span id="contador-jogadores">1</span>/15</p>
                <p>Status: <span id="status-sala">Aguardando jogadores...</span></p>
            </div>
            
            <div class="jogadores-sala" id="jogadores-sala">
                <!-- Jogadores ser√£o inseridos dinamicamente -->
            </div>
            
            <div id="aguardando-inicio" class="sala-aguardando">
                <p>Aguardando o dono da sala iniciar o jogo...</p>
                <p>M√≠nimo de 2 jogadores necess√°rios</p>
            </div>
            
            <button id="btn-iniciar-jogo" disabled>Iniciar Jogo</button>
            <button class="voltar-btn">Sair da Sala</button>
        </div>
        
        <!-- Tela de Pergunta Multiplayer -->
        <div id="tela-pergunta-multiplayer" class="tela">
            <h2>Quiz Multiplayer</h2>
            <div class="contador-tempo">Tempo: <span id="tempo-restante-multi">15</span>s</div>
            <div class="barra-progresso">
                <div class="progresso" id="barra-progresso-multi"></div>
            </div>
            
            <div class="pergunta-container">
                <div class="pergunta-texto" id="texto-pergunta-multi">Carregando pergunta...</div>
                <div class="opcoes-container" id="opcoes-container-multi">
                    <!-- Op√ß√µes ser√£o inseridas dinamicamente -->
                </div>
            </div>
            
            <div class="ranking-sala" id="ranking-sala">
                <!-- Ranking em tempo real ser√° inserido aqui -->
            </div>
        </div>
        
        <!-- Tela de Resultado Multiplayer -->
        <div id="tela-resultado-multiplayer" class="tela">
            <h2>Resultado da Rodada</h2>
            <div class="resultado-container">
                <div id="resultado-texto-multi" class="resultado-acerto">Resposta Correta!</div>
                <p>Pontua√ß√£o desta rodada: <span id="pontuacao-rodada">0</span> pontos</p>
            </div>
            
            <div class="ranking-sala">
                <h3>Ranking da Sala</h3>
                <div id="ranking-rodada">
                    <!-- Ranking da rodada ser√° inserido aqui -->
                </div>
            </div>
            
            <div id="aguardando-proxima" class="sala-aguardando">
                <p>Aguardando pr√≥xima pergunta...</p>
            </div>
        </div>
        
        <!-- Tela de Ranking -->
        <div id="tela-ranking" class="tela">
            <h2>Ranking Global</h2>
            <div class="ranking-container" id="ranking-container">
                <!-- Itens de ranking ser√£o inseridos dinamicamente -->
            </div>
            <button class="voltar-btn">Voltar</button>
        </div>
        
        <!-- Tela de √Ålbum -->
        <div id="tela-album" class="tela">
            <h2>√Ålbum de Figurinhas</h2>
            
            <div class="filtro-categorias">
                <button class="filtro-btn ativo" data-categoria="todas">Todas</button>
                <button class="filtro-btn" data-categoria="comum">Comum</button>
                <button class="filtro-btn" data-categoria="rara">Rara</button>
                <button class="filtro-btn" data-categoria="lendaria">Lend√°ria</button>
            </div>
            
            <div class="album-container" id="album-container">
                <!-- Figurinhas ser√£o inseridas dinamicamente -->
            </div>
            
            <button class="voltar-btn">Voltar</button>
        </div>
    </div>

    <script>
        // Dados do jogo
        const perguntas = {
            "facil": [
                {
                    "pergunta": "Quem construiu a arca?",
                    "opcoes": ["Mois√©s", "No√©", "Abra√£o", "Josu√©"],
                    "resposta": "No√©"
                },
                {
                    "pergunta": "Quantos disc√≠pulos Jesus escolheu?",
                    "opcoes": ["7", "12", "10", "15"],
                    "resposta": "12"
                },
                {
                    "pergunta": "Qual foi o primeiro milagre de Jesus?",
                    "opcoes": ["Cura do cego", "Ressurrei√ß√£o de L√°zaro", "Transforma√ß√£o de √°gua em vinho", "Caminhar sobre as √°guas"],
                    "resposta": "Transforma√ß√£o de √°gua em vinho"
                },
                {
                    "pergunta": "Quem foi jogado na cova dos le√µes?",
                    "opcoes": ["Jos√©", "Davi", "Daniel", "Jonas"],
                    "resposta": "Daniel"
                },
                {
                    "pergunta": "Qual √© o primeiro livro da B√≠blia?",
                    "opcoes": ["√äxodo", "G√™nesis", "Mateus", "Salmos"],
                    "resposta": "G√™nesis"
                }
            ],
            "medio": [
                {
                    "pergunta": "Qual ap√≥stolo era coletor de impostos antes de seguir Jesus?",
                    "opcoes": ["Pedro", "Jo√£o", "Mateus", "Andr√©"],
                    "resposta": "Mateus"
                },
                {
                    "pergunta": "Quem foi o primeiro m√°rtir da igreja crist√£?",
                    "opcoes": ["Pedro", "Paulo", "Est√™v√£o", "Tiago"],
                    "resposta": "Est√™v√£o"
                },
                {
                    "pergunta": "Qual profeta foi engolido por um grande peixe?",
                    "opcoes": ["Jeremias", "Isa√≠as", "Jonas", "Ezequiel"],
                    "resposta": "Jonas"
                },
                {
                    "pergunta": "Quem interpretou o sonho de Fara√≥ sobre as vacas magras e gordas?",
                    "opcoes": ["Mois√©s", "Jos√©", "Daniel", "Salom√£o"],
                    "resposta": "Jos√©"
                }
            ],
            "dificil": [
                {
                    "pergunta": "Quantos anos tinha No√© quando come√ßou a chover para o dil√∫vio?",
                    "opcoes": ["500 anos", "600 anos", "700 anos", "800 anos"],
                    "resposta": "600 anos"
                },
                {
                    "pergunta": "Qual ap√≥stolo era conhecido como 'Zelote'?",
                    "opcoes": ["Sim√£o", "Judas Iscariotes", "Judas Tadeu", "Tiago"],
                    "resposta": "Sim√£o"
                },
                {
                    "pergunta": "Em qual livro da B√≠blia encontramos a hist√≥ria de Ester?",
                    "opcoes": ["Rute", "Ester", "Esdras", "Neemias"],
                    "resposta": "Ester"
                },
                {
                    "pergunta": "Quem foi o pai de Isaque?",
                    "opcoes": ["Abra√£o", "Jac√≥", "Ismael", "Esa√∫"],
                    "resposta": "Abra√£o"
                }
            ]
        };

        const figurinhas = [
            { nome: "Pomba Branca", categoria: "comum", icon: "üïäÔ∏è" },
            { nome: "Arca de No√©", categoria: "comum", icon: "üö¢" },
            { nome: "T√°buas da Lei", categoria: "comum", icon: "üìú" },
            { nome: "Cruz", categoria: "comum", icon: "‚úùÔ∏è" },
            { nome: "Peixe Crist√£o", categoria: "comum", icon: "üêü" },
            { nome: "David com Harpa", categoria: "rara", icon: "üéµ" },
            { nome: "Sans√£o", categoria: "rara", icon: "üí™" },
            { nome: "Muro de Jeric√≥", categoria: "rara", icon: "üß±" },
            { nome: "Man√° do C√©u", categoria: "rara", icon: "üçû" },
            { nome: "Arca da Alian√ßa", categoria: "lendaria", icon: "üì¶" },
            { nome: "Ressurrei√ß√£o", categoria: "lendaria", icon: "‚ú®" },
            { nome: "Transfigura√ß√£o", categoria: "lendaria", icon: "üåü" }
        ];

        // Simula√ß√£o do Backend com Socket.IO
        class SocketIOSimulado {
            constructor() {
                this.eventos = {};
                this.salas = new Map();
                this.jogadores = new Map();
                this.intervalos = {};
            }

            on(evento, callback) {
                if (!this.eventos[evento]) {
                    this.eventos[evento] = [];
                }
                this.eventos[evento].push(callback);
            }

            emit(evento, dados) {
                // Simular delay de rede
                setTimeout(() => {
                    this.processarEvento(evento, dados);
                }, 100 + Math.random() * 200);
            }

            processarEvento(evento, dados) {
                switch(evento) {
                    case 'criarSala':
                        this.criarSala(dados);
                        break;
                    case 'entrarSala':
                        this.entrarSala(dados);
                        break;
                    case 'iniciarJogo':
                        this.iniciarJogo(dados);
                        break;
                    case 'responderPergunta':
                        this.processarResposta(dados);
                        break;
                    case 'sairSala':
                        this.sairSala(dados);
                        break;
                }
            }

            criarSala(dados) {
                const salaId = this.gerarIdSala();
                const sala = {
                    id: salaId,
                    jogadores: [dados.jogador],
                    dono: dados.jogador.id,
                    estado: 'aguardando',
                    rodadaAtual: 0,
                    perguntas: this.sortearPerguntasMultiplayer(),
                    tempoResposta: 15
                };

                this.salas.set(salaId, sala);
                this.jogadores.set(dados.jogador.id, { ...dados.jogador, salaId });

                // Notificar o criador da sala
                this.dispararEvento('salaCriada', { sala });
                this.dispararEvento('jogadoresAtualizados', { 
                    salaId, 
                    jogadores: sala.jogadores,
                    dono: sala.dono
                });
            }

            entrarSala(dados) {
                const sala = this.salas.get(dados.salaId);
                if (!sala) {
                    this.dispararEvento('erroEntrada', { mensagem: 'Sala n√£o encontrada' });
                    return;
                }

                if (sala.jogadores.length >= 15) {
                    this.dispararEvento('erroEntrada', { mensagem: 'Sala cheia' });
                    return;
                }

                if (sala.estado !== 'aguardando') {
                    this.dispararEvento('erroEntrada', { mensagem: 'Jogo em andamento' });
                    return;
                }

                // Verificar se jogador j√° est√° na sala
                if (sala.jogadores.some(j => j.id === dados.jogador.id)) {
                    this.dispararEvento('erroEntrada', { mensagem: 'Voc√™ j√° est√° nesta sala' });
                    return;
                }

                sala.jogadores.push(dados.jogador);
                this.jogadores.set(dados.jogador.id, { ...dados.jogador, salaId: dados.salaId });

                this.dispararEvento('entradaConfirmada', { sala });
                this.dispararEvento('jogadoresAtualizados', { 
                    salaId: dados.salaId, 
                    jogadores: sala.jogadores,
                    dono: sala.dono
                });

                // Notificar outros jogadores
                this.dispararEvento('novoJogador', { 
                    salaId: dados.salaId, 
                    jogador: dados.jogador 
                });
            }

            iniciarJogo(dados) {
                const sala = this.salas.get(dados.salaId);
                if (!sala || sala.dono !== dados.jogadorId) return;

                if (sala.jogadores.length < 2) return;

                sala.estado = 'jogando';
                sala.rodadaAtual = 0;

                // Iniciar primeira rodada ap√≥s 3 segundos
                setTimeout(() => {
                    this.iniciarRodada(sala.id);
                }, 3000);

                this.dispararEvento('jogoIniciado', { salaId: sala.id });
            }

            iniciarRodada(salaId) {
                const sala = this.salas.get(salaId);
                if (!sala) return;

                sala.rodadaAtual++;
                sala.tempoRestante = sala.tempoResposta;
                sala.respostas = new Map();

                if (sala.rodadaAtual > sala.perguntas.length) {
                    this.finalizarJogo(salaId);
                    return;
                }

                const pergunta = sala.perguntas[sala.rodadaAtual - 1];
                
                this.dispararEvento('novaPergunta', {
                    salaId,
                    pergunta,
                    rodada: sala.rodadaAtual,
                    totalRodadas: sala.perguntas.length
                });

                // Iniciar contagem regressiva
                sala.intervalo = setInterval(() => {
                    sala.tempoRestante--;

                    this.dispararEvento('tempoAtualizado', {
                        salaId,
                        tempoRestante: sala.tempoRestante
                    });

                    if (sala.tempoRestante <= 0) {
                        clearInterval(sala.intervalo);
                        this.finalizarRodada(salaId);
                    }
                }, 1000);
            }

            processarResposta(dados) {
                const sala = this.salas.get(dados.salaId);
                if (!sala || sala.estado !== 'jogando') return;

                // Registrar resposta
                sala.respostas.set(dados.jogadorId, {
                    resposta: dados.resposta,
                    tempo: sala.tempoResposta - sala.tempoRestante
                });

                // Atualizar progresso dos jogadores
                this.dispararEvento('respostaRegistrada', {
                    salaId: dados.salaId,
                    jogadorId: dados.jogadorId
                });

                // Verificar se todos responderam
                if (sala.respostas.size === sala.jogadores.length) {
                    clearInterval(sala.intervalo);
                    this.finalizarRodada(dados.salaId);
                }
            }

            finalizarRodada(salaId) {
                const sala = this.salas.get(salaId);
                if (!sala) return;

                const pergunta = sala.perguntas[sala.rodadaAtual - 1];
                const resultados = [];

                // Calcular pontua√ß√£o para cada jogador
                sala.jogadores.forEach(jogador => {
                    const resposta = sala.respostas.get(jogador.id);
                    let pontos = 0;
                    let acertou = false;

                    if (resposta && resposta.resposta === pergunta.resposta) {
                        acertou = true;
                        // Pontua√ß√£o base: 10 pontos + b√¥nus por velocidade
                        pontos = 10 + Math.floor((sala.tempoResposta - resposta.tempo) / 3);
                    }

                    jogador.pontuacao = (jogador.pontuacao || 0) + pontos;
                    resultados.push({
                        jogador,
                        acertou,
                        pontos,
                        pontosTotais: jogador.pontuacao
                    });
                });

                // Ordenar por pontua√ß√£o
                resultados.sort((a, b) => b.pontosTotais - a.pontosTotais);

                this.dispararEvento('rodadaFinalizada', {
                    salaId,
                    resultados,
                    pergunta: pergunta.pergunta,
                    respostaCorreta: pergunta.resposta,
                    rodada: sala.rodadaAtual,
                    totalRodadas: sala.perguntas.length
                });

                // Preparar pr√≥xima rodada ap√≥s 5 segundos
                setTimeout(() => {
                    this.iniciarRodada(salaId);
                }, 5000);
            }

            finalizarJogo(salaId) {
                const sala = this.salas.get(salaId);
                if (!sala) return;

                sala.estado = 'finalizado';
                
                // Ordenar jogadores por pontua√ß√£o final
                const ranking = [...sala.jogadores].sort((a, b) => (b.pontuacao || 0) - (a.pontuacao || 0));

                this.dispararEvento('jogoFinalizado', {
                    salaId,
                    ranking
                });
            }

            sairSala(dados) {
                const jogador = this.jogadores.get(dados.jogadorId);
                if (!jogador) return;

                const sala = this.salas.get(jogador.salaId);
                if (!sala) return;

                // Remover jogador da sala
                sala.jogadores = sala.jogadores.filter(j => j.id !== dados.jogadorId);
                this.jogadores.delete(dados.jogadorId);

                // Se era o dono, transferir propriedade
                if (sala.dono === dados.jogadorId && sala.jogadores.length > 0) {
                    sala.dono = sala.jogadores[0].id;
                }

                // Se sala ficar vazia, remov√™-la
                if (sala.jogadores.length === 0) {
                    this.salas.delete(sala.id);
                } else {
                    this.dispararEvento('jogadoresAtualizados', {
                        salaId: sala.id,
                        jogadores: sala.jogadores,
                        dono: sala.dono
                    });

                    this.dispararEvento('jogadorSaiu', {
                        salaId: sala.id,
                        jogadorId: dados.jogadorId
                    });
                }
            }

            sortearPerguntasMultiplayer() {
                // Misturar perguntas de todas as dificuldades para o multiplayer
                const todasPerguntas = [
                    ...perguntas.facil,
                    ...perguntas.medio,
                    ...perguntas.dificil
                ].sort(() => Math.random() - 0.5);

                return todasPerguntas.slice(0, 5); // 5 perguntas por jogo
            }

            gerarIdSala() {
                return Math.random().toString(36).substring(2, 8).toUpperCase();
            }

            dispararEvento(evento, dados) {
                if (this.eventos[evento]) {
                    this.eventos[evento].forEach(callback => {
                        setTimeout(() => callback(dados), 50);
                    });
                }
            }
        }

        // Estado do jogo
        let estadoJogo = {
            jogador: {
                id: null,
                nome: "Jogador",
                pontuacao: 0,
                figurinhas: []
            },
            modo: null,
            dificuldade: null,
            perguntaAtual: null,
            perguntasRespondidas: [],
            tempoRestante: 30,
            intervalo: null,
            opcaoSelecionada: null,
            sala: null,
            socket: null
        };

        // Inicializar socket simulado
        estadoJogo.socket = new SocketIOSimulado();

        // Elementos da interface
        const telas = document.querySelectorAll('.tela');
        const telaInicial = document.getElementById('tela-inicial');
        const telaDificuldade = document.getElementById('tela-dificuldade');
        const telaPergunta = document.getElementById('tela-pergunta');
        const telaResultado = document.getElementById('tela-resultado');
        const telaMultiplayer = document.getElementById('tela-multiplayer');
        const telaEntrarSala = document.getElementById('tela-entrar-sala');
        const telaSala = document.getElementById('tela-sala');
        const telaPerguntaMultiplayer = document.getElementById('tela-pergunta-multiplayer');
        const telaResultadoMultiplayer = document.getElementById('tela-resultado-multiplayer');
        const telaRanking = document.getElementById('tela-ranking');
        const telaAlbum = document.getElementById('tela-album');

        // Configurar listeners do socket
        estadoJogo.socket.on('salaCriada', (dados) => {
            estadoJogo.sala = dados.sala;
            atualizarTelaSala();
            mostrarTela(telaSala);
        });

        estadoJogo.socket.on('entradaConfirmada', (dados) => {
            estadoJogo.sala = dados.sala;
            atualizarTelaSala();
            mostrarTela(telaSala);
        });

        estadoJogo.socket.on('erroEntrada', (dados) => {
            alert(dados.mensagem);
        });

        estadoJogo.socket.on('jogadoresAtualizados', (dados) => {
            if (estadoJogo.sala && estadoJogo.sala.id === dados.salaId) {
                estadoJogo.sala.jogadores = dados.jogadores;
                estadoJogo.sala.dono = dados.dono;
                atualizarTelaSala();
            }
        });

        estadoJogo.socket.on('novoJogador', (dados) => {
            if (estadoJogo.sala && estadoJogo.sala.id === dados.salaId) {
                // Adicionar mensagem de sistema
                adicionarMensagemSistema(`${dados.jogador.nome} entrou na sala`);
            }
        });

        estadoJogo.socket.on('jogadorSaiu', (dados) => {
            if (estadoJogo.sala && estadoJogo.sala.id === dados.salaId) {
                adicionarMensagemSistema('Um jogador saiu da sala');
            }
        });

        estadoJogo.socket.on('jogoIniciado', (dados) => {
            if (estadoJogo.sala && estadoJogo.sala.id === dados.salaId) {
                document.getElementById('aguardando-inicio').style.display = 'none';
                adicionarMensagemSistema('Jogo iniciando...');
            }
        });

        estadoJogo.socket.on('novaPergunta', (dados) => {
            if (estadoJogo.sala && estadoJogo.sala.id === dados.salaId) {
                estadoJogo.sala.perguntaAtual = dados.pergunta;
                estadoJogo.sala.rodadaAtual = dados.rodada;
                estadoJogo.sala.tempoRestante = 15;
                carregarPerguntaMultiplayer(dados.pergunta, dados.rodada, dados.totalRodadas);
                mostrarTela(telaPerguntaMultiplayer);
            }
        });

        estadoJogo.socket.on('tempoAtualizado', (dados) => {
            if (estadoJogo.sala && estadoJogo.sala.id === dados.salaId) {
                document.getElementById('tempo-restante-multi').textContent = dados.tempoRestante;
                const progresso = (dados.tempoRestante / 15) * 100;
                document.getElementById('barra-progresso-multi').style.width = `${progresso}%`;
            }
        });

        estadoJogo.socket.on('respostaRegistrada', (dados) => {
            if (estadoJogo.sala && estadoJogo.sala.id === dados.salaId) {
                // Atualizar progresso dos jogadores no ranking
                atualizarRankingSala();
            }
        });

        estadoJogo.socket.on('rodadaFinalizada', (dados) => {
            if (estadoJogo.sala && estadoJogo.sala.id === dados.salaId) {
                mostrarResultadoMultiplayer(dados);
            }
        });

        // Fun√ß√µes de navega√ß√£o
        function mostrarTela(tela) {
            telas.forEach(t => t.classList.remove('ativa'));
            tela.classList.add('ativa');
        }

        // Event listeners para navega√ß√£o
        document.getElementById('btn-solo').addEventListener('click', () => {
            estadoJogo.modo = 'solo';
            mostrarTela(telaDificuldade);
        });

        document.getElementById('btn-multiplayer').addEventListener('click', () => {
            estadoJogo.modo = 'multiplayer';
            mostrarTela(telaMultiplayer);
        });

        document.getElementById('btn-ranking').addEventListener('click', () => {
            carregarRanking();
            mostrarTela(telaRanking);
        });

        document.getElementById('btn-album').addEventListener('click', () => {
            carregarAlbum();
            mostrarTela(telaAlbum);
        });

        document.querySelectorAll('.voltar-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                if (estadoJogo.sala) {
                    estadoJogo.socket.emit('sairSala', {
                        jogadorId: estadoJogo.jogador.id
                    });
                    estadoJogo.sala = null;
                }
                mostrarTela(telaInicial);
                resetarJogo();
            });
        });

        // Modo Solo - Sele√ß√£o de dificuldade
        document.querySelectorAll('.dificuldade-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                estadoJogo.dificuldade = e.target.dataset.dificuldade;
                iniciarJogoSolo();
            });
        });

        // Modo Solo - Iniciar jogo
        function iniciarJogoSolo() {
            estadoJogo.perguntasRespondidas = [];
            estadoJogo.jogador.pontuacao = 0;
            carregarPergunta();
            mostrarTela(telaPergunta);
        }

        // Carregar pergunta aleat√≥ria (Solo)
        function carregarPergunta() {
            // Filtrar perguntas n√£o respondidas
            const perguntasDisponiveis = perguntas[estadoJogo.dificuldade].filter(
                p => !estadoJogo.perguntasRespondidas.includes(p.pergunta)
            );
            
            if (perguntasDisponiveis.length === 0) {
                // Todas as perguntas foram respondidas
                alert('Parab√©ns! Voc√™ completou todas as perguntas deste n√≠vel!');
                mostrarTela(telaInicial);
                return;
            }
            
            // Selecionar pergunta aleat√≥ria
            const indiceAleatorio = Math.floor(Math.random() * perguntasDisponiveis.length);
            estadoJogo.perguntaAtual = perguntasDisponiveis[indiceAleatorio];
            
            // Atualizar interface
            document.getElementById('texto-pergunta').textContent = estadoJogo.perguntaAtual.pergunta;
            
            const opcoesContainer = document.getElementById('opcoes-container');
            opcoesContainer.innerHTML = '';
            
            estadoJogo.perguntaAtual.opcoes.forEach(opcao => {
                const divOpcao = document.createElement('div');
                divOpcao.className = 'opcao';
                divOpcao.textContent = opcao;
                divOpcao.addEventListener('click', () => selecionarOpcao(divOpcao, opcao));
                opcoesContainer.appendChild(divOpcao);
            });
            
            // Resetar estado
            estadoJogo.opcaoSelecionada = null;
            document.getElementById('btn-confirmar').disabled = true;
            estadoJogo.tempoRestante = 30;
            document.getElementById('tempo-restante').textContent = estadoJogo.tempoRestante;
            
            // Atualizar barra de progresso
            const progresso = (estadoJogo.perguntasRespondidas.length / perguntas[estadoJogo.dificuldade].length) * 100;
            document.getElementById('barra-progresso').style.width = `${progresso}%`;
            
            // Iniciar contador
            clearInterval(estadoJogo.intervalo);
            estadoJogo.intervalo = setInterval(atualizarTempo, 1000);
        }

        function selecionarOpcao(elemento, opcao) {
            // Remover sele√ß√£o anterior
            document.querySelectorAll('.opcao').forEach(op => {
                op.classList.remove('selecionada');
            });
            
            // Selecionar nova op√ß√£o
            elemento.classList.add('selecionada');
            estadoJogo.opcaoSelecionada = opcao;
            document.getElementById('btn-confirmar').disabled = false;
        }

        document.getElementById('btn-confirmar').addEventListener('click', verificarResposta);

        function verificarResposta() {
            clearInterval(estadoJogo.intervalo);
            
            // Marcar pergunta como respondida
            estadoJogo.perguntasRespondidas.push(estadoJogo.perguntaAtual.pergunta);
            
            // Verificar se a resposta est√° correta
            const correta = estadoJogo.opcaoSelecionada === estadoJogo.perguntaAtual.resposta;
            
            // Atualizar pontua√ß√£o
            let pontos = 0;
            if (correta) {
                switch(estadoJogo.dificuldade) {
                    case 'facil': pontos = 10; break;
                    case 'medio': pontos = 20; break;
                    case 'dificil': pontos = 30; break;
                }
                estadoJogo.jogador.pontuacao += pontos;
            }
            
            // Mostrar resultado
            mostrarResultado(correta, pontos);
        }

        function atualizarTempo() {
            estadoJogo.tempoRestante--;
            document.getElementById('tempo-restante').textContent = estadoJogo.tempoRestante;
            
            if (estadoJogo.tempoRestante <= 0) {
                clearInterval(estadoJogo.intervalo);
                // Tempo esgotado - resposta incorreta
                estadoJogo.perguntasRespondidas.push(estadoJogo.perguntaAtual.pergunta);
                mostrarResultado(false, 0);
            }
        }

        function mostrarResultado(correta, pontos) {
            const resultadoTexto = document.getElementById('resultado-texto');
            const figurinhaContainer = document.getElementById('figurinha-ganha-container');
            
            if (correta) {
                resultadoTexto.textContent = "Resposta Correta!";
                resultadoTexto.className = "resultado-acerto";
                
                // Chance de ganhar figurinha (50% de chance)
                if (Math.random() < 0.5) {
                    const figurinha = ganharFigurinha();
                    if (figurinha) {
                        figurinhaContainer.style.display = 'block';
                        document.getElementById('figurinha-ganha-info').innerHTML = `
                            <div class="figurinha-icon">${figurinha.icon}</div>
                            <div class="figurinha-nome">${figurinha.nome}</div>
                            <div class="figurinha-categoria">${figurinha.categoria}</div>
                        `;
                    } else {
                        figurinhaContainer.style.display = 'none';
                    }
                } else {
                    figurinhaContainer.style.display = 'none';
                }
            } else {
                resultadoTexto.textContent = "Resposta Incorreta!";
                resultadoTexto.className = "resultado-erro";
                figurinhaContainer.style.display = 'none';
            }
            
            document.getElementById('pontuacao-atual').textContent = estadoJogo.jogador.pontuacao;
            mostrarTela(telaResultado);
        }

        // Modo Multiplayer
        document.getElementById('btn-criar-sala').addEventListener('click', criarSala);
        document.getElementById('btn-entrar-sala').addEventListener('click', () => {
            mostrarTela(telaEntrarSala);
        });

        document.getElementById('btn-confirmar-entrada').addEventListener('click', entrarSala);

        function criarSala() {
            // Gerar ID √∫nico para o jogador
            if (!estadoJogo.jogador.id) {
                estadoJogo.jogador.id = 'jogador_' + Date.now();
            }
            
            estadoJogo.socket.emit('criarSala', {
                jogador: estadoJogo.jogador
            });
        }

        function entrarSala() {
            const salaId = document.getElementById('input-id-sala').value.toUpperCase();
            if (!salaId || salaId.length !== 6) {
                alert('Digite um ID de sala v√°lido (6 caracteres)');
                return;
            }

            if (!estadoJogo.jogador.id) {
                estadoJogo.jogador.id = 'jogador_' + Date.now();
            }
            
            estadoJogo.socket.emit('entrarSala', {
                salaId: salaId,
                jogador: estadoJogo.jogador
            });
        }

        function atualizarTelaSala() {
            if (!estadoJogo.sala) return;

            document.getElementById('sala-id').textContent = estadoJogo.sala.id;
            document.getElementById('contador-jogadores').textContent = estadoJogo.sala.jogadores.length;
            document.getElementById('status-sala').textContent = 
                estadoJogo.sala.estado === 'aguardando' ? 'Aguardando jogadores...' : 'Jogo em andamento';
            
            const jogadoresContainer = document.getElementById('jogadores-sala');
            jogadoresContainer.innerHTML = '';
            
            estadoJogo.sala.jogadores.forEach(jogador => {
                const divJogador = document.createElement('div');
                divJogador.className = 'jogador-item';
                
                if (jogador.id === estadoJogo.sala.dono) {
                    divJogador.classList.add('dono');
                    divJogador.innerHTML = `üëë ${jogador.nome} (Dono)`;
                } else if (jogador.id === estadoJogo.jogador.id) {
                    divJogador.classList.add('eu');
                    divJogador.innerHTML = `‚≠ê ${jogador.nome} (Voc√™)`;
                } else {
                    divJogador.textContent = jogador.nome;
                }
                
                jogadoresContainer.appendChild(divJogador);
            });
            
            // Mostrar/ocultar bot√£o de iniciar
            const btnIniciar = document.getElementById('btn-iniciar-jogo');
            if (estadoJogo.sala.dono === estadoJogo.jogador.id) {
                btnIniciar.style.display = 'block';
                btnIniciar.disabled = estadoJogo.sala.jogadores.length < 2;
            } else {
                btnIniciar.style.display = 'none';
            }

            // Mostrar/ocultar √°rea de aguardo
            document.getElementById('aguardando-inicio').style.display = 
                estadoJogo.sala.estado === 'aguardando' ? 'block' : 'none';
        }

        document.getElementById('btn-iniciar-jogo').addEventListener('click', () => {
            estadoJogo.socket.emit('iniciarJogo', {
                salaId: estadoJogo.sala.id,
                jogadorId: estadoJogo.jogador.id
            });
        });

        function adicionarMensagemSistema(mensagem) {
            const mensagemElemento = document.createElement('div');
            mensagemElemento.className = 'mensagem-sistema';
            mensagemElemento.textContent = mensagem;
            
            const salaContainer = document.querySelector('#tela-sala .sala-container');
            salaContainer.appendChild(mensagemElemento);
            
            // Rolagem autom√°tica para a mensagem mais recente
            mensagemElemento.scrollIntoView({ behavior: 'smooth' });
            
            // Remover mensagem ap√≥s 5 segundos
            setTimeout(() => {
                if (mensagemElemento.parentNode) {
                    mensagemElemento.parentNode.removeChild(mensagemElemento);
                }
            }, 5000);
        }

        // Perguntas Multiplayer
        function carregarPerguntaMultiplayer(pergunta, rodada, totalRodadas) {
            document.getElementById('texto-pergunta-multi').textContent = `Rodada ${rodada}/${totalRodadas}: ${pergunta.pergunta}`;
            
            const opcoesContainer = document.getElementById('opcoes-container-multi');
            opcoesContainer.innerHTML = '';
            
            pergunta.opcoes.forEach(opcao => {
                const divOpcao = document.createElement('div');
                divOpcao.className = 'opcao';
                divOpcao.textContent = opcao;
                divOpcao.addEventListener('click', () => responderPerguntaMultiplayer(opcao, divOpcao));
                opcoesContainer.appendChild(divOpcao);
            });
            
            // Resetar tempo
            document.getElementById('tempo-restante-multi').textContent = '15';
            document.getElementById('barra-progresso-multi').style.width = '100%';
            
            // Atualizar ranking
            atualizarRankingSala();
        }

        function responderPerguntaMultiplayer(resposta, elemento) {
            // Desabilitar todas as op√ß√µes
            document.querySelectorAll('#opcoes-container-multi .opcao').forEach(opcao => {
                opcao.style.pointerEvents = 'none';
            });
            
            // Marcar op√ß√£o selecionada
            elemento.classList.add('selecionada');
            
            // Enviar resposta
            estadoJogo.socket.emit('responderPergunta', {
                salaId: estadoJogo.sala.id,
                jogadorId: estadoJogo.jogador.id,
                resposta: resposta
            });
        }

        function atualizarRankingSala() {
            if (!estadoJogo.sala) return;

            const rankingContainer = document.getElementById('ranking-sala');
            rankingContainer.innerHTML = '<h3>Ranking da Sala</h3>';
            
            // Ordenar jogadores por pontua√ß√£o
            const jogadoresOrdenados = [...estadoJogo.sala.jogadores].sort((a, b) => 
                (b.pontuacao || 0) - (a.pontuacao || 0)
            );
            
            jogadoresOrdenados.forEach((jogador, index) => {
                const divRanking = document.createElement('div');
                divRanking.className = 'ranking-sala-item';
                
                if (jogador.id === estadoJogo.jogador.id) {
                    divRanking.classList.add('destaque');
                }
                
                // Verificar se o jogador j√° respondeu
                const respondeu = estadoJogo.sala.respostas && 
                                 estadoJogo.sala.respostas.has(jogador.id);
                
                divRanking.innerHTML = `
                    <div>
                        <strong>${index + 1}¬∫ ${jogador.nome}</strong>
                        ${jogador.id === estadoJogo.jogador.id ? '(Voc√™)' : ''}
                        ${respondeu ? '‚úÖ' : '‚è≥'}
                    </div>
                    <div>${jogador.pontuacao || 0} pontos</div>
                `;
                
                rankingContainer.appendChild(divRanking);
            });
        }

        function mostrarResultadoMultiplayer(dados) {
            // Encontrar resultado do jogador atual
            const meuResultado = dados.resultados.find(r => 
                r.jogador.id === estadoJogo.jogador.id
            );
            
            // Atualizar interface
            document.getElementById('resultado-texto-multi').textContent = 
                meuResultado.acertou ? 'Resposta Correta!' : 'Resposta Incorreta!';
            document.getElementById('resultado-texto-multi').className = 
                meuResultado.acertou ? 'resultado-acerto' : 'resultado-erro';
            document.getElementById('pontuacao-rodada').textContent = meuResultado.pontos;
            
            // Mostrar ranking da rodada
            const rankingContainer = document.getElementById('ranking-rodada');
            rankingContainer.innerHTML = '';
            
            dados.resultados.forEach((resultado, index) => {
                const divRanking = document.createElement('div');
                divRanking.className = 'ranking-sala-item';
                
                if (resultado.jogador.id === estadoJogo.jogador.id) {
                    divRanking.classList.add('destaque');
                }
                
                divRanking.innerHTML = `
                    <div>
                        <strong>${index + 1}¬∫ ${resultado.jogador.nome}</strong>
                        ${resultado.jogador.id === estadoJogo.jogador.id ? '(Voc√™)' : ''}
                    </div>
                    <div>
                        <div>+${resultado.pontos} pts (Total: ${resultado.pontosTotais})</div>
                        <div class="progresso-jogador" style="width: ${(resultado.pontosTotais / (dados.rodada * 15)) * 100}%"></div>
                    </div>
                `;
                
                rankingContainer.appendChild(divRanking);
            });
            
            mostrarTela(telaResultadoMultiplayer);
            
            // Se for a √∫ltima rodada, voltar para a sala ap√≥s alguns segundos
            if (dados.rodada === dados.totalRodadas) {
                setTimeout(() => {
                    mostrarTela(telaSala);
                }, 5000);
            }
        }

        // Fun√ß√µes auxiliares (ganharFigurinha, carregarRanking, carregarAlbum, etc.)
        // ... (manter as fun√ß√µes existentes do c√≥digo anterior)

        function ganharFigurinha() {
            // Implementa√ß√£o existente...
        }

        function carregarRanking() {
            // Implementa√ß√£o existente...
        }

        function carregarAlbum() {
            // Implementa√ß√£o existente...
        }

        function resetarJogo() {
            // Implementa√ß√£o existente...
        }

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', () => {
            // Carregar dados do jogador do localStorage
            const dadosSalvos = localStorage.getItem('quizBiblicoJogador');
            if (dadosSalvos) {
                const dados = JSON.parse(dadosSalvos);
                estadoJogo.jogador = { ...estadoJogo.jogador, ...dados };
            }
            
            // Gerar ID √∫nico para o jogador se n√£o existir
            if (!estadoJogo.jogador.id) {
                estadoJogo.jogador.id = 'jogador_' + Date.now();
            }
            
            // Salvar dados do jogador periodicamente
            setInterval(() => {
                localStorage.setItem('quizBiblicoJogador', JSON.stringify(estadoJogo.jogador));
            }, 5000);
        });

        // Adicionar filtro de categorias no √°lbum
        document.querySelectorAll('.filtro-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                document.querySelectorAll('.filtro-btn').forEach(b => b.classList.remove('ativo'));
                e.target.classList.add('ativo');
                filtrarAlbum(e.target.dataset.categoria);
            });
        });

        function filtrarAlbum(categoria) {
            const cards = document.querySelectorAll('.figurinha-card');
            cards.forEach(card => {
                if (categoria === 'todas' || card.classList.contains(categoria)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>